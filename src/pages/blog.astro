---
import Layout from '../layouts/Layout.astro';
import Container from '../components/Container.astro';
import ButtonSub from '../components/ButtonSub.astro';

// Metadatos para SEO
const title = "Blog de Salud Mental | Artículos y Recursos | MenteSana";
const description = "Artículos, consejos y recursos sobre psicología, salud mental y bienestar emocional. Información basada en evidencia científica por nuestros especialistas.";
const keywords = "blog psicología, artículos salud mental, recursos bienestar emocional, consejos psicológicos, ansiedad, depresión, mindfulness, autoayuda";
const image = "/img/blog/blog-header.jpg";

// Esto sería reemplazado por datos reales de un CMS o base de datos
const articles = [
  {
    id: 1,
    title: '5 técnicas efectivas para manejar la ansiedad en situaciones cotidianas',
    excerpt: 'Descubre estrategias prácticas y basadas en evidencia para gestionar los síntomas de ansiedad y recuperar el control en tu día a día.',
    category: 'Ansiedad',
    categoryColor: 'bg-blue-500',
    image: '/img/blog/article1.jpg',
    date: '15 Mayo, 2023',
    readTime: '5 min lectura',
    author: 'Dra. María Rodríguez',
    authorImage: '/img/team/psychologist1.jpg',
    slug: '/blog/tecnicas-manejo-ansiedad'
  },
  {
    id: 2,
    title: 'Etapas del desarrollo emocional en niños: guía para padres',
    excerpt: 'Comprende las diferentes fases del desarrollo emocional infantil y aprende cómo acompañar a tu hijo en cada etapa para promover su bienestar.',
    category: 'Infancia',
    categoryColor: 'bg-green-500',
    image: '/img/blog/article2.jpg',
    date: '2 Junio, 2023',
    readTime: '7 min lectura',
    author: 'Dr. Carlos Mendoza',
    authorImage: '/img/team/psychologist1.jpg',
    slug: '/blog/desarrollo-emocional-infantil'
  },
  {
    id: 3,
    title: 'Comunicación efectiva en pareja: claves para evitar conflictos',
    excerpt: 'Aprende a mejorar la comunicación con tu pareja mediante técnicas que fomentan la empatía, la escucha activa y la resolución constructiva de conflictos.',
    category: 'Relaciones',
    categoryColor: 'bg-red-500',
    image: '/img/blog/article3.jpg',
    date: '20 Mayo, 2023',
    readTime: '6 min lectura',
    author: 'Dra. Laura Sánchez',
    authorImage: '/img/team/psychologist1.jpg',
    slug: '/blog/comunicacion-efectiva-pareja'
  },
  {
    id: 4,
    title: 'La importancia del autocuidado en tiempos de estrés',
    excerpt: 'Descubre por qué el autocuidado es fundamental para mantener tu salud mental, especialmente en momentos de alta presión y estrés.',
    category: 'Bienestar',
    categoryColor: 'bg-purple-500',
    image: '/img/blog/article1.jpg',
    date: '10 Junio, 2023',
    readTime: '4 min lectura',
    author: 'Dr. Javier Martínez',
    authorImage: '/img/team/psychologist1.jpg',
    slug: '/blog/autocuidado-tiempos-estres'
  },
  {
    id: 5,
    title: 'Cómo superar una ruptura: guía psicológica para el duelo emocional',
    excerpt: 'Estrategias efectivas para procesar el dolor emocional tras una ruptura y reconstruir tu vida con fortaleza y nuevas perspectivas.',
    category: 'Duelo',
    categoryColor: 'bg-indigo-500',
    image: '/img/blog/article2.jpg',
    date: '5 Junio, 2023',
    readTime: '8 min lectura',
    author: 'Dra. Ana García',
    authorImage: '/img/team/psychologist1.jpg',
    slug: '/blog/superar-ruptura-duelo-emocional'
  },
  {
    id: 6,
    title: 'Mindfulness para principiantes: guía práctica para empezar',
    excerpt: 'Una introducción sencilla a la práctica del mindfulness, con ejercicios prácticos que puedes incorporar a tu rutina diaria para reducir el estrés.',
    category: 'Mindfulness',
    categoryColor: 'bg-teal-500',
    image: '/img/blog/article3.jpg',
    date: '1 Junio, 2023',
    readTime: '5 min lectura',
    author: 'Dr. Roberto Sánchez',
    authorImage: '/img/team/psychologist1.jpg',
    slug: '/blog/mindfulness-principiantes'
  },
  {
    id: 7,
    title: 'Trastornos del sueño: causas, síntomas y tratamientos',
    excerpt: 'Análisis de los principales trastornos del sueño, sus posibles causas psicológicas y las opciones de tratamiento más efectivas según la evidencia.',
    category: 'Sueño',
    categoryColor: 'bg-blue-400',
    image: '/img/blog/article1.jpg',
    date: '28 Mayo, 2023',
    readTime: '7 min lectura',
    author: 'Dra. Elena Torres',
    authorImage: '/img/team/psychologist1.jpg',
    slug: '/blog/trastornos-sueno-tratamientos'
  },
  {
    id: 8,
    title: 'El síndrome del impostor: cómo identificarlo y superarlo',
    excerpt: 'Aprende a reconocer este fenómeno psicológico común y estrategias efectivas para gestionarlo y recuperar la confianza en tus capacidades.',
    category: 'Autoestima',
    categoryColor: 'bg-yellow-500',
    image: '/img/blog/article2.jpg',
    date: '25 Mayo, 2023',
    readTime: '6 min lectura',
    author: 'Dr. Miguel López',
    authorImage: '/img/team/psychologist1.jpg',
    slug: '/blog/sindrome-impostor'
  },
  {
    id: 9,
    title: 'Gestión de las emociones en el entorno laboral',
    excerpt: 'Herramientas prácticas para manejar el estrés, la frustración y otras emociones desafiantes en el ambiente de trabajo.',
    category: 'Laboral',
    categoryColor: 'bg-gray-500',
    image: '/img/blog/article3.jpg',
    date: '22 Mayo, 2023',
    readTime: '5 min lectura',
    author: 'Dra. Claudia Ramírez',
    authorImage: '/img/team/psychologist1.jpg',
    slug: '/blog/gestion-emociones-trabajo'
  },
  {
    id: 10,
    title: 'Cómo el estrés crónico afecta a tu cuerpo y mente',
    excerpt: 'Descubre los efectos del estrés prolongado en la salud física y mental, y estrategias efectivas para manejarlo antes de que cause daños.',
    category: 'Bienestar',
    categoryColor: 'bg-purple-500',
    image: '/img/blog/article1.jpg',
    date: '2023-05-28',
    readTime: '7 min lectura',
    author: 'Dr. Pablo Torres',
    authorImage: '/img/team/psychologist1.jpg',
    slug: '/blog/estrés-crónico-cuerpo-mente'
  },
  {
    id: 11,
    title: 'El síndrome del impostor: cómo identificarlo y superarlo',
    excerpt: 'Aprende a reconocer este fenómeno psicológico común y estrategias efectivas para gestionarlo y recuperar la confianza en tus capacidades.',
    category: 'Autoestima',
    categoryColor: 'bg-yellow-500',
    image: '/img/blog/article2.jpg',
    date: '25 Mayo, 2023',
    readTime: '6 min lectura',
    author: 'Dr. Carlos Menéndez',
    authorImage: '/img/team/psychologist1.jpg',
    slug: '/blog/sindrome-impostor'
  }
];

// Paginación simple
const articlesPerPage = 6;
const totalPages = Math.ceil(articles.length / articlesPerPage);
const currentPage = 1;
const paginatedArticles = articles.slice(
  (currentPage - 1) * articlesPerPage,
  currentPage * articlesPerPage
);

// Categorías para Schema.org
const categories = [...new Set(articles.map(article => article.category))];
---

<Layout 
  title={title}
  description={description}
  keywords={keywords}
  image={image}
  canonicalURL={Astro.url.href}
>
  <main id="main-content">
    <section class="w-full max-w-6xl mx-auto px-4 sm:px-6 py-12 sm:py-16 mt-20">
      <div class="text-center mb-12">
        <p class="text-primary-400 font-semibold tracking-widest text-sm mb-2 uppercase">Nuestro Blog</p>
        <h1 class="text-4xl sm:text-5xl font-bold text-gray-100 mb-4">Artículos sobre salud mental</h1>
        <p class="text-base sm:text-lg text-gray-400 max-w-2xl mx-auto">Recursos, consejos y novedades sobre psicología y bienestar emocional. Conocimiento basado en evidencia para tu crecimiento personal.</p>
      </div>
      
      <!-- Filtros -->
      <div class="flex flex-wrap justify-center gap-3 mb-12" aria-label="Filtros de categorías">
        <button class="bg-primary-500 text-white px-4 py-2 rounded-full text-sm font-medium cursor-pointer">Todos</button>
        {categories.map(category => (
          <button class="bg-dark-300/50 text-gray-300 hover:bg-primary-500/20 px-4 py-2 rounded-full text-sm font-medium transition-colors cursor-pointer">{category}</button>
        ))}
      </div>
      
      <!-- Artículos -->
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 sm:gap-8">
        {paginatedArticles.map(article => (
          <article class="bg-dark-300/30 rounded-xl overflow-hidden shadow-lg border border-dark-200/30 hover:border-primary-500/30 transition-all duration-300 group" data-scroll-animation="fade-up">
            <div class="relative overflow-hidden">
              <img 
                src={article.image} 
                alt={article.title} 
                class="w-full h-48 object-cover transition-transform duration-500 group-hover:scale-110"
                width="600"
                height="400"
                loading="lazy"
              />
              <div class="absolute inset-0 bg-gradient-to-t from-gray-900 to-transparent opacity-60"></div>
              <div class="absolute bottom-0 left-0 p-4">
                <span class={`${article.categoryColor} text-white text-xs font-semibold px-3 py-1 rounded-full`}>{article.category}</span>
              </div>
            </div>
            
            <div class="p-6">
              <div class="flex items-center text-gray-400 text-sm mb-2">
                <span>
                  <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 inline mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                  </svg>
                  <time datetime={new Date(article.date).toISOString().split('T')[0]}>{article.date}</time>
                </span>
                <span class="mx-2">·</span>
                <span>{article.readTime}</span>
              </div>
              
              <h3 class="text-xl font-semibold text-gray-100 mb-3 group-hover:text-primary-400 transition-colors">{article.title}</h3>
              
              <p class="text-gray-400 mb-4">{article.excerpt}</p>
              
              <div class="flex items-center">
                <img 
                  src={article.authorImage} 
                  alt={article.author} 
                  class="w-8 h-8 rounded-full object-cover mr-3"
                  width="40"
                  height="40"
                  loading="lazy"
                />
                <span class="text-sm text-gray-300">{article.author}</span>
              </div>
            </div>
            
            <div class="px-6 pb-6">
              <ButtonSub to={article.slug + "/"}>Leer más</ButtonSub>
            </div>
          </article>
        ))}
      </div>
      
      <!-- Paginación -->
      <div class="mt-10 flex justify-center">
        <nav aria-label="Paginación">
          <ul class="flex gap-2">
            {Array.from({ length: totalPages }).map((_, index) => (
              <li>
                <a 
                  href={`/blog${index === 0 ? "/" : "/page/" + (index + 1) + "/"}`}
                  class={`flex items-center justify-center w-10 h-10 rounded-full ${
                    index + 1 === currentPage
                      ? "bg-primary-500 text-white"
                      : "bg-dark-300/50 text-gray-300 hover:bg-primary-500/20"
                  }`}
                  aria-current={index + 1 === currentPage ? "page" : undefined}
                >
                  {index + 1}
                </a>
              </li>
            ))}
          </ul>
        </nav>
      </div>
    </section>
  </main>
</Layout>

<!-- Schema.org markup para el Blog -->
<script type="application/ld+json" set:html={JSON.stringify({
  "@context": "https://schema.org",
  "@type": "Blog",
  "headline": "Blog de Salud Mental de MenteSana",
  "description": description,
  "url": Astro.url.href,
  "image": new URL(image, Astro.site || Astro.url.href).toString(),
  "publisher": {
    "@type": "Organization",
    "name": "MenteSana - Centro de Psicología",
    "logo": {
      "@type": "ImageObject",
      "url": new URL("/img/logo.svg", Astro.site || Astro.url.href).toString()
    }
  },
  "blogPost": paginatedArticles.map(article => ({
    "@type": "BlogPosting",
    "headline": article.title,
    "description": article.excerpt,
    "image": new URL(article.image, Astro.site || Astro.url.href).toString(),
    "datePublished": new Date(article.date).toISOString(),
    "author": {
      "@type": "Person",
      "name": article.author
    },
    "url": new URL(article.slug, Astro.site || Astro.url.href).toString(),
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": new URL(article.slug, Astro.site || Astro.url.href).toString()
    }
  }))
})}>
</script>

<style>
  [data-scroll-animation] {
    opacity: 0;
    transition: opacity 0.6s ease, transform 0.6s ease;
  }
  
  [data-scroll-animation].animated {
    opacity: 1;
  }
  
  [data-scroll-animation="fade-up"].animated {
    transform: translateY(0);
  }
  
  [data-scroll-animation="fade-up"] {
    transform: translateY(30px);
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    // Configurar animaciones al scroll
    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          const animationType = entry.target.getAttribute('data-scroll-animation');
          if (animationType) {
            entry.target.classList.add(animationType, 'animated');
          }
          observer.unobserve(entry.target);
        }
      });
    }, {
      threshold: 0.15,
      rootMargin: '0px 0px -50px 0px'
    });
    
    // Observe all elements with data-scroll-animation
    document.querySelectorAll('[data-scroll-animation]').forEach(element => {
      observer.observe(element);
    });
  });
</script> 